<!DOCTYPE html>
<html>
<head>
<title>觸控與繪圖測試</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
  body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: #f0f0f0;
    /* 防止在畫布上拖曳時選取到頁面其他文字 */
    user-select: none;
  }
  #drawing-canvas {
    background-color: #ffffff;
    cursor: crosshair;
    /* 確保 canvas 在最底層，不會蓋住按鈕 */
    position: absolute;
    top: 0;
    left: 0;
    z-index: 1;
  }
  #info {
    position: fixed;
    top: 10px;
    left: 10px;
    padding: 10px;
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    font-family: monospace;
    font-size: 18px;
    border-radius: 5px;
    z-index: 10; /* 確保資訊框在最上層 */
  }
  /* 清除按鈕的樣式 */
  #clear-btn {
    position: fixed;
    top: 10px;
    right: 10px;
    padding: 8px;
    background-color: rgba(255, 255, 255, 0.8);
    border: 1px solid #ccc;
    border-radius: 5px;
    cursor: pointer;
    z-index: 10; /* 確保按鈕在最上層 */
    transition: background-color 0.2s;
  }
  #clear-btn:hover {
    background-color: rgba(224, 224, 224, 0.9);
  }
  #clear-btn svg {
    width: 24px;
    height: 24px;
    display: block; /* 移除 svg 下方的多餘空間 */
  }
</style>
</head>
<body>

<!-- 資訊顯示區塊 -->
<div id="info">請觸控、或按住滑鼠左鍵拖曳</div>

<!-- 清除按鈕 (使用內嵌 SVG 圖示) -->
<div id="clear-btn" title="清除畫布">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <polyline points="3 6 5 6 21 6"></polyline>
    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
    <line x1="10" y1="11" x2="10" y2="17"></line>
    <line x1="14" y1="11" x2="14" y2="17"></line>
  </svg>
</div>

<!-- 繪圖畫布 -->
<canvas id="drawing-canvas" width="1920" height="1080"></canvas>

<script>
  // 取得 DOM 元素
  const canvas = document.getElementById('drawing-canvas');
  const info = document.getElementById('info');
  const clearButton = document.getElementById('clear-btn');
  const ctx = canvas.getContext('2d');

  let isDrawing = false;
  let lastX = 0;
  let lastY = 0;

  // 設定線條樣式
  ctx.strokeStyle = '#000000';
  ctx.lineWidth = 1;
  ctx.lineCap = 'round';
  ctx.lineJoin = 'round';

  // --- 繪圖相關函式 ---

  function getCoordinates(event) {
    let x, y;
    const rect = canvas.getBoundingClientRect();
    if (event.type.startsWith('touch')) {
      const touch = event.touches[0] || event.changedTouches[0];
      x = touch.clientX - rect.left;
      y = touch.clientY - rect.top;
    } else {
      x = event.clientX - rect.left;
      y = event.clientY - rect.top;
    }
    return { x, y };
  }

  function startDrawing(event) {
    isDrawing = true;
    const { x, y } = getCoordinates(event);
    [lastX, lastY] = [x, y];
    info.innerHTML = `點位: (${Math.round(x)}, ${Math.round(y)})`;
  }

  function draw(event) {
    if (!isDrawing || (event.buttons !== 1 && !event.type.startsWith('touch'))) {
      if (isDrawing) stopDrawing();
      return;
    }
    event.preventDefault();
    const { x, y } = getCoordinates(event);
    ctx.beginPath();
    ctx.moveTo(lastX, lastY);
    ctx.lineTo(x, y);
    ctx.stroke();
    [lastX, lastY] = [x, y];
    info.innerHTML = `點位: (${Math.round(x)}, ${Math.round(y)})`;
  }

  function stopDrawing() {
    isDrawing = false;
  }

  // --- 新增的清除畫布函式 ---
  function clearCanvas() {
    // 清除整個畫布
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }

  // --- 事件監聽 ---

  // 滑鼠事件
  canvas.addEventListener('mousedown', startDrawing);
  canvas.addEventListener('mousemove', draw);
  canvas.addEventListener('mouseup', stopDrawing);
  canvas.addEventListener('mouseout', stopDrawing);

  // 觸控事件
  canvas.addEventListener('touchstart', startDrawing);
  canvas.addEventListener('touchmove', draw);
  canvas.addEventListener('touchend', stopDrawing);

  // 清除按鈕的點擊事件
  clearButton.addEventListener('click', clearCanvas);

</script>

</body>
</html>